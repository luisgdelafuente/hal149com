---

import { Image } from 'astro:assets';
import Logo from '../assets/theme-images/hal149logo.png'
import LanguageSwitcher from './LanguageSwitcher.astro'
import MobileMenu from './MobileMenu.astro'
import { getLangFromUrl, useTranslations } from '../i18n/ui';
import { createNavLink } from '../i18n/utils';

const { settings } = Astro.props
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

---

<header class="wrapper bg-loop font-semibold">

  <!-- Wrapper -->
  <div class="bs-container py-6 flex justify-between items-center">

    <!-- Logo -->
    <a class="flex xl:min-w-32" href={lang === 'en' ? '/' : '/es/'} aria-label={ settings.title + ' - Home' }>

      <Image 
        src={Logo} 
        alt={settings.title}
        class="h-10 w-auto max-w-32 md:h-12 md:max-w-40"
      />

    </a>

    <!-- Nav -->
    <nav class="hidden md:flex mx-auto items-center gap-2">

      <!-- Debug: Show navigation data -->
      <!-- {JSON.stringify(settings.nav)} -->

      <!-- Links -->
      { settings.nav.map( (item, index) =>

        <a class="bs-btn !bg-transparent before:translate-y-full hover:before:translate-y-0" href={createNavLink(lang, item.link)}>
          { item.title }
        </a>

      )}



    </nav>

    <!-- Desktop: Language Switcher and CTA -->
    <div class="hidden md:flex items-center gap-4">
      
      <!-- Language Switcher -->
      <LanguageSwitcher />

      <!-- CTA -->
      <button type="button" class="min-w-32 bs-btn" onclick="demo.showModal()">

        { t('contact.title') }

      </button>

    </div>

    <!-- Mobile: Language Switcher, CTA and Hamburger Menu -->
    <div class="md:hidden flex items-center gap-4">
      
      <!-- Language Switcher -->
      <LanguageSwitcher />

      <!-- CTA -->
      <button type="button" class="bs-btn" onclick="demo.showModal()">

        { t('contact.title') }

      </button>

      <!-- Hamburger Menu Button -->
      <button 
        id="mobile-menu-open"
        class="p-2 text-bs-foreground-light hover:text-white transition-colors"
        aria-label={t('menu.open')}
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>

    </div>

  </div>

  <!-- Mobile Menu Component -->
  <MobileMenu settings={settings} />

</header>
