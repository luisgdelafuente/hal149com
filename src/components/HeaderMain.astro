---

import Logo from '../assets/theme-images/logo.svg'
import LanguageSwitcher from './LanguageSwitcher.astro'
import MobileMenu from './MobileMenu.astro'
import { getLangFromUrl, useTranslations } from '../i18n/ui';
import { createNavLink } from '../i18n/utils';

const { settings } = Astro.props
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

---

<header class="wrapper bg-loop font-semibold">

  <!-- Wrapper -->
  <div class="bs-container py-6 flex justify-between items-center">

    <!-- Logo -->
    <a class="flex xl:min-w-32 group" href={lang === 'en' ? '/' : '/es/'} aria-label={ settings.title + ' - Home' }>

      <Logo class="group-hover:-rotate-180 group-hover:scale-80 transition-transform ease-bs-spring duration-1000" height="48" width="48" />

    </a>

    <!-- Nav -->
    <nav class="hidden col-span-6 md:flex mx-auto self-stretch lg:gap-2">

      <!-- Links -->
      { settings.nav.map( item =>

        <a class="bs-btn !bg-transparent before:translate-y-full hover:before:translate-y-0" href={createNavLink(lang, item.link)}>
          { item.title }
        </a>

      )}

    </nav>

    <!-- Desktop: Language Switcher and CTA -->
    <div class="hidden md:flex items-center gap-4">
      
      <!-- Language Switcher -->
      <LanguageSwitcher />

      <!-- CTA -->
      <button type="button" class="min-w-32 bs-btn" onclick="demo.showModal()">

        { settings.demo.title }

      </button>

    </div>

    <!-- Mobile: Language Switcher, CTA and Hamburger Menu -->
    <div class="md:hidden flex items-center gap-4">
      
      <!-- Language Switcher -->
      <LanguageSwitcher />

      <!-- CTA -->
      <button type="button" class="bs-btn" onclick="demo.showModal()">

        { settings.demo.title }

      </button>

      <!-- Hamburger Menu Button -->
      <button 
        id="mobile-menu-open"
        class="p-2 text-bs-foreground-light hover:text-white transition-colors"
        aria-label={t('menu.open')}
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>

    </div>

  </div>

  <!-- Mobile Menu Component -->
  <MobileMenu settings={settings} />

</header>
