---

import Image from "astro/components/Image.astro"

// Import case study images from assets for optimization
import pixelateImage from "../assets/content-images/pixelate.pictures.avif"
import spikeImage from "../assets/content-images/spike.news.avif"
// Note: brighton.dog.avif is not available in assets, will use original path

const { caseStudy } = Astro.props

// Map image paths to imported assets
const imageMap = {
  "/content-images/pixelate.pictures.avif": pixelateImage,
  "/content-images/spike.news.avif": spikeImage,
  // brighton.dog.avif will use original path from public folder
}

// Get the optimized image or fallback to original path
const optimizedImage = imageMap[caseStudy.image] || caseStudy.image

---

<!-- Wrapper -->
<div class="group @container">

  <!-- Case study -->
  <article
    class:list={["relative isolate flex h-full w-full gap-6 overflow-hidden rounded-xl pt-[20rem] @md:pt-[28rem] @xl:justify-end @4xl:pt-0", caseStudy.bg]}>

    <Image
      src={ optimizedImage }
      alt={ caseStudy.image_alt }
      width={400}
      height={300}
      widths={[300, 400, 500]}
      sizes="(max-width: 768px) 90vw, (max-width: 1200px) 60vw, 400px"
      format="avif"
      quality={80}
      class="drop-shadow-[0_100px_100px_rgba(0,0,0,0.5)] absolute top-[4cqb] left-8 mx-auto w-[90cqi] rounded-xl @4xl:w-[60cqi] group-hover:scale-105 transition-transform duration-3000 ease-bs-spring transform-gpu"
      loading="lazy"
    />

    <!-- Content -->
    <div class="z-10 flex h-full w-full flex-col gap-6 bg-bs-surface-0/50 backdrop-blur-3xl p-6 @4xl:w-1/2 @4xl:p-20">

      <!-- Header -->
      <header class="flex flex-col gap-3">

        <!-- Title -->
        <div class:list={["text-xs uppercase tracking-widest font-semibold text-transparent bg-clip-text bg-gradient-to-r", caseStudy.bg]} set:html={ caseStudy.sector } />

        <!-- Tag -->
        <h2 class="bs-h2" set:html={ caseStudy.title } />

      </header>

      <!-- Intro -->
      <div class="bs-body-text flex-grow text-balance" set:html={ caseStudy.content } />

      <!-- CTA -->
      <a href={ caseStudy.case_study_link } class="bs-btn inline-block self-start @4xl:mt-12">
        { caseStudy.cta }
      </a>

    </div>

  </article>

</div>
