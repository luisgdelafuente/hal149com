---
/**
 * Sanity Studio Route
 *
 * This page serves the Sanity Studio CMS interface.
 * Access it at /studio to manage blog content.
 *
 * Note: For production, you can either:
 * 1. Use this embedded route (requires some Vite config)
 * 2. Deploy studio separately at sanity.io (recommended)
 * 3. Use the Sanity CLI: npx sanity deploy
 *
 * Authentication is handled by Sanity's built-in auth system.
 */

// This route must not be prerendered to allow dynamic studio loading
export const prerender = false;

// Get environment variables for client-side use
const projectId = import.meta.env.PUBLIC_SANITY_PROJECT_ID || '';
const dataset = import.meta.env.PUBLIC_SANITY_DATASET || 'production';
---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no, viewport-fit=cover" />
    <meta name="robots" content="noindex" />
    <meta name="referrer" content="same-origin" />
    <title>HAL149 Blog CMS | Sanity Studio</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />

    <!-- Sanity Studio CSS -->
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        background: #1a1a1a;
        color: #fff;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }
      .studio-loader {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        gap: 1rem;
      }
      .studio-loader h1 {
        font-size: 1.5rem;
        font-weight: 600;
      }
      .studio-loader p {
        color: #888;
      }
      .studio-loader a {
        color: #0070f3;
        text-decoration: underline;
      }
      .studio-loader .options {
        margin-top: 2rem;
        display: flex;
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }
      .studio-loader .btn {
        display: inline-block;
        padding: 0.75rem 1.5rem;
        background: #0070f3;
        color: white;
        border-radius: 0.5rem;
        text-decoration: none;
        font-weight: 500;
      }
      .studio-loader .btn:hover {
        background: #0060df;
      }
    </style>
  </head>
  <body>
    <div class="studio-loader">
      <h1>HAL149 Blog CMS</h1>
      <p>Sanity Studio for content management</p>

      <div class="options">
        <p>
          <strong>Project ID:</strong> {projectId || 'Not configured'}<br/>
          <strong>Dataset:</strong> {dataset}
        </p>

        {projectId ? (
          <>
            <p>Access your Sanity Studio:</p>
            <a
              href={`https://${projectId}.sanity.studio/`}
              target="_blank"
              rel="noopener noreferrer"
              class="btn"
            >
              Open Sanity Studio
            </a>
            <p style="font-size: 0.875rem; color: #666;">
              Or use the Sanity CLI locally:<br/>
              <code style="background: #333; padding: 0.25rem 0.5rem; border-radius: 0.25rem;">npx sanity dev</code>
            </p>
          </>
        ) : (
          <>
            <p style="color: #f44;">
              Sanity project not configured.
            </p>
            <p>Set up your environment variables:</p>
            <code style="display: block; background: #333; padding: 1rem; border-radius: 0.5rem; text-align: left; white-space: pre;">
PUBLIC_SANITY_PROJECT_ID=your-project-id
PUBLIC_SANITY_DATASET=production
SANITY_API_TOKEN=your-token</code>
          </>
        )}
      </div>
    </div>
  </body>
</html>
